<table>
<tr class="form_subtitle"><td><h4>PSI-BLAST Domain Profile</h4></td></tr>

<tr><td>
<% results.each do |job_state|
  if (job_state.status_class == 14 ) && (job_state.content_name =~ /myps/) %>
      <a href="<%= url_for(:controller => "bio_serf", :action => "getresultattached", :id => job_state.id) %>"><img src="<%= url_for(:controller => "bio_serf", :action => "getresultattached", :id => job_state.id) %>" /></a>
  <% end
   end %>
</td></tr>
<tr><td>Aligned termini profile: Indicates the density of the end points of PSI-BLAST alignments which were generated between the query sequence and all the PSI-BLAST hits which were found, given a PSI-BLAST run against a database with all sequence fragments removed.<br /><br /><br /><br /></td></tr>

<%  count = 0
results.each do |job_state|
    if (job_state.status_class == 29 )
      text = job_state.data
      lines = text.split(/\n/)
      count = lines.length
    end
end %>

<tr><td><h3>Putative Domain boundaries found by PSI-BLAST:</h3></td></tr>
<% results.each do |job_state|
  if (job_state.status_class == 28 )
    text = job_state.data
    lines = text.split(/\n/)
    lines.each do |line| %>
      <tr><td><h4><%= line %></h4></td></tr>
    <%  end
   end
end %>

<tr><td><h4>Number of PSIBLAST hits = <%= (count-1) %></h4></td></tr>

<tr class="form_subtitle"><td><h4>DomSSEA Results</h4></td></tr>
<% results.each do |job_state|
  if (job_state.status_class == 27 )%>
    <tr><td><%= render :partial => 'layouts/domssea_result', :locals => {:log_result => job_state, :bgcolor => "#ccc"} %></td></tr>
    <% end
   end %>

</table>

